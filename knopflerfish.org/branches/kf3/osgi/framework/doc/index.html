<h1>Knopflerfish OSGi framework</h1>

<div class="abstract">
  This is the Knopflerfish framework. An OSGi Release 4 version 4.2
  compliant framework. It supports all optional framework services,
  Package Admin, Start Level, Conditional Permission Admin,
  Permission Admin, URL Handlers and Service Hooks.
</div>

<h2>Contents</h2>
  <ol>
    <li><a href="#startup">Knopflerfish framework.jar startup</a></li>
    <li><a href="#init_restart">Initial start vs restart</a></li>
    <li><a href="#framework">Starting the framework</a></li>
    <li><a href="#xargs">Default selection of .xargs</a></li>
    <li><a href="#proxy">Using a HTTP proxy</a></li>
    <li><a href="#osgiprop">OSGi Specified Framework Properties</a></li>
    <li><a href="#kfprop">Knopflerfish Specified Framework Properties</a></li>
  </ol>
<a name="startup"></a>
<h2>Knopflerfish framework.jar startup</h2>
<p>
This is a startup guide for the KF OSGi framework. Note that
command-line startup of the framework is not specified by OSGi, and
system integrators often need to create a wrapper script for FW
startup.
</p>
<p>
The KF Main startup class is primarily intended to be used in scenarios
where current working directory is same as the one containing framework.jar,
the framework storage directory and configuration files. In these cases
</p>
<p>
<tt>java -jar framework.jar</tt>
</p>
<p>
...is often enough. 
</p>
<p>
To enable support for new KF2 specific features, such as extension bundles, 
you can use the "kf2" shell script. Open a terminal and type
</p>
<p>
<tt>./kf2</tt>
</p>
<p>
Note: the script requires a "sh" shell. 
</p>
<p>
Other uses are possible, but require options and possibly some tweaking
of the default startup files.
</p>

<a name="init_restart"></a>
<h2>Initial start vs restart</h2>
<p>
Two cases of framework startup should be noted:
</p>
<ol>
  <li>Initial, bootstrap, startup<br/>
    An initial startup must contains enough options
    to install bundles allowing further management, using 
    -install options. If no bundles are installed, an empty 
    framework will be started but nothing can be done with it..
  </li>
  <li>Restart of previously initialized framework<br/>
    Any OSGi framework can remember its state from previous startup.
    <br/>
    In this case, startup options should only contains system properties
    and a -launch option for restarting the bundles, but not any
    -install options.
  </li>
 </ol>
<p>
 NB! Since these two different cases probably will use separate startup
     files, care must be taken so system properties a set correctly in
     both files, when so required.
</p>
<p>
It is up to a system integrator to decide when to use initial startup
or restart. The Main KF class can help somewhat in doing this (see below)
but might not be enough. In those cases, wrapper scripts, or modifications
to Main.java are recommended.
</p>

<a name="framework"></a>
<h2>Starting the framework</h2>
<p>
The framework can be started using the startup wrapper class
</p>
<p>
<tt>org.knopflerfish.framework.Main</tt>
</p>
<p>
This class is also set a Main-Class in framework.jar's manifest, meaning 
framework.jar can be started using 
</p>
<p>
<tt> java -jar framework.jar [options] OR ./kf2 [options]</tt>
</p>
<p>
The Main class supports a number of options, which can be displayed
using:
</p>
<p>
<tt>java -jar framework.jar -help OR ./kf2 -help</tt>
</p>
<p>
Options can also be specified using the -xargs option, which specifies
a .xargs text file containing lines of new options. Typically all
options are specified in .xargs files. Combining .xargs files and
command line options is possible. .xargs files can also use recursive
.xargs files.
</p>
<p>
When the framework is started, it uses a file system directory for
storing the state of all installed bundles, "fwdir". The default
directory used for this is:
</p>
<p>
<tt>fwdir</tt>
</p>
<p>
in the currect directory. The "fwdir" directory can also be set
specifically using the org.osgi.framework.storage property. Note that
moving "fwdir" also changes the location for searching for default
.xargs files.
</p>
<p>
If no options are specified (any "-Fx=y", "-Da=b" or "-init" does not
count as options in this case) an implicit
</p>
<p>
<tt>-xargs "default"</tt>
</p>
<p>
is added to the options. "default" means that the default .xargs (see
below) is selected.
</p>

<a name="xargs"></a>
<h2>Default selection of .xargs</h2>
<p>
If _no_ args are supplied (arguments of the form "-Fx=y", "-Da=b" or
"-init" does not count in this case), or a name of "default" is given
as -xargs argument, a default .xargs file will be searched for, by the
following algorithm:
</p>
<ol>
  <li>If there exists a previous "fwdir" AND previous options
      does not contain "-init", search for a file named:<br/>
    <tt>restart.xargs</tt>
  </li>
  <li>If no fwdir exist, OR options contain an "-init", 
       search for a file named:
    <ol style="list-style-type:lower-latin">
      <li>init_[osname].xargs</li>
      <li>init.xargs</li>
      <li>remote-init.xargs</li>
    </ol>
    The search is performed in the following directories:
    <ol style="list-style-type:lower-latin">
      <li>fwdir</li>
      <li>The parent directory of fwdir (if any)</li>
      <li>The current working directory</li>
    </ol>
    First match winns.<br/>
    The [osname]-part of the file name is the unified OS name as
    specified in Alias.java (see below). Case is important if the file
    system is case sensitive.<br/>
    OS aliases:
    <ul>
      <li>OS2</li>
      <li>QNX</li>
      <li>Windows95</li>
      <li>Windows98</li>
      <li>WindowsNT</li>
      <li>WindowsCE</li>
      <li>Windows2000</li>
      <li>WindowsXP</li>
    </ul>
  </li>
</ol>
<p>
The file fwdir/restart.xargs suitable for restarting a framework
instance is written by the Knopflerfish framework on every startup
(unless disabled by setting the property
"org.knopflerfish.framework.write.restart.xargs" to false).
</p>

<a name="proxy"></a>
<h2>Using a HTTP proxy</h2>
<p>
The standard JVM system properties
</p>
<p>
 http.proxyHost
 http.proxyPort
 http.nonProxyHosts 
</p>
<p>
should be used to set proxy information. This will be global to 
all HTTP request from all bundles and the framework.
</p>
<p>
Additionally, the KF-specific system property
</p>
<p>
 http.proxyAuth
</p>
<p>
can be set to a value on the form user:password
</p>
<p>
If set to non-empty, this will add the 
Proxy-Authorization header to bundle install http/https requests 
made from the framework, However, bundles using the URL class internally
must explictly set this header themselves.
</p>

<a name="osgiprop"></a>
<h2>OSGi Specified Framework Properties</h2>

<table border="1">
  <tr>
    <th>Name</th>
    <th>Description</th>
    <th>Value type</th>
    <th>Default value</th>
  </tr>
  <tr>
    <td>org.osgi.framework.bootdelegation</td>
    <td>
      Set the boot delegation mask. A list of packages delegated from the
      framework to the parent classloader. The package specified can contain
      a wildcard at the end, which matches any sub-packages.
    </td>
    <td>String , ...</td>
    <td></td>
  </tr>
  <tr>
    <td>org.osgi.framework.bundle.parent</td>
    <td>
      This property is used to specify what class loader is used for 
      boot delegation. That is, java.* and the packages specified on 
      the org.osgi.framework.bootdelegation.
      This property can have the following values: boot, app, ext or
      framework.
    </td>
    <td>String</td>
    <td>boot</td>
  </tr>
  <tr>
    <td>org.osgi.framework.command.execpermission</td>
    <td>
      Specifies an optional OS specific command to set file permissions
      on a bundle's native code. This is required on some operating
      systems to use native libraries. For example, on a UNIX 
      style OS you could have the following value: 
      org.osgi.framework.command.execpermission="chmod +rx ${abspath}" 
      The ${abspath} macro will be substituted for the actual file 
      path. 
    </td>
    <td>String</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.osgi.framework.executionenvironment</td>
    <td>
      The current execution environment. There are no restriction on
      the execution environment if this property isn't set.
    </td>
    <td>String</td>
    <td>Set based on system property java.version, if unknown set
      to OSGi/Minimum-1.2</td>
  </tr>
  <tr>
    <td>org.osgi.framework.language</td>
    <td>
      The language used by the framework for the selection of 
      native code.
    </td>
    <td>String</td>
    <td>Set based on default locale</td>
  </tr>
  <tr>
    <td>org.osgi.framework.library.extensions</td>
    <td>
      A comma separated list of additional library file extensions that
      must be used when searching for native code. If not set, then only
      the library name returned by System.mapLibraryName(String) will be
      used. This list of extensions is needed for certain operating
      systems which allow more than one extension for native libraries.
      For example, the AIX operating system allows library extensions of
      .a and .so, but System.mapLibraryName(String) will only return
      names with the .a extension.
    </td>
    <td>String , ...</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.osgi.framework.os.name</td>
    <td>
      The name of the operating system as used in the native code clause.
    </td>
    <td>String</td>
    <td>Set based on system property os.name</td>
  </tr>
  <tr>
    <td>org.osgi.framework.os.version</td>
    <td>
      The version of the operating system as used in the native code 
      clause.
    </td>
    <td>String</td>
    <td>Set based on system property os.version</td>
  </tr>
  <tr>
    <td>org.osgi.framework.os.processor</td>
    <td>
      The name of the processor as used in the native code clause.
    </td>
    <td></td>
    <td>Set based on system property os.arch</td>
  </tr>
  <tr>
    <td>org.osgi.framework.security</td>
    <td>
      Specifies the type of security manager the framework must 
      use. If not specified then the framework will not set the VM 
      security manager. The following type is architected: 
      <code>osgi</code> Enables a security manager that supports all 
      security aspects of the OSGi Release 4 specifications 
      (including postponed conditions). 
      If specified, and there is a security manager that doesn't
      match already installed, then a SecurityException is thrown
      when the Framework is initialized. 
    </td>
    <td>String</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.osgi.framework.startlevel.beginning</td>
    <td>
      Specifies the beginning start level of the framework.
    </td>
    <td>Integer</td>
    <td>1</td>
  </tr>
  <tr>
    <td>org.osgi.framework.storage</td>
    <td>
      Where we store persistent data.

      On systems not supporting a current working directory,
      as Pocket PC, this path should be set to an explicit
      full path.

      Note: Knopflerfish 1.x and 2.x used the name
      "org.osgi.framework.dir" for this property.
    </td>
    <td>String</td>
    <td>${currentWorkingDirectory}/fwdir</td>
  </tr>
  <tr>
    <td>org.osgi.framework.storage.clean</td>
    <td>
      Specifies if and when the storage area for the framework 
      should be cleaned. If no value is specified, the framework storage
      area will not be cleaned. The possible values is: 
      <code>onFirstInit</code> - The framework storage area will be
      cleaned  before the Framework bundle is initialized for the first 
      time. Subsequent inits, starts or updates of the Framework bundle
      will not result in cleaning the framework storage area.
    </td>
    <td>String</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.osgi.framework.system.packages</td>
    <td>
      Complete list of packages exported by the system bundle.

      If not set the framework will export all OSGi packages and all
      standard Java packages according to the version of the running
      JRE. See also "org.knopflerfish.framework.system.export"
      and "org.osgi.framework.system.packages.extra"
    </td>
    <td>String , ...</td>
    <td>Default is based on other properties</td>
  </tr>
  <tr>
    <td>org.osgi.framework.system.packages.extra</td>
    <td>
      Packages to add to the default list of packages exported by the
      system bundle.
    </td>
    <td>String , ...</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.osgi.framework.trust.repositories</td>
    <td>
      This property is used to configure trust repositories for the 
      framework. The value is path of files.The file paths are separated
      by the pathSeparator defined in the File class. Each file path
      should point to a JKS key store. The framework will use the key
      stores as trust repositories to authenticate certificates of
      trusted signers. The key stores must only be used as read-only
      trust repositories to access public keys. The keystore must not
      have a password.
    </td>
    <td>String : ...</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.osgi.framework.windowsystem</td>
    <td>
      Provide the name of the current window system. This can be used by
      the native code clause.
    </td>
    <td>String</td>
    <td>-</td>
  </tr>
</table>


<a name="kfprop"></a>
<h2>Knopflerfish Specified Framework Properties</h2>

<table border="1">
  <tr>
    <th>Name</th>
    <th>Description</th>
    <th>Value type</th>
    <th>Default value</th>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.all_signed</td>
    <td>
      If set to true, we require that all bundles that are installed are signed.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.automanifest</td>
    <td>
      Flag to enable automatic manifest generation. If true, bundle
      manifest can be modified by a special configuration file. See
      javadoc for org.knopflerfish.framework.AutoManifest class 
      for details.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.automanifest.config</td>
    <td>
      Configuration URL for automatic manifest generation. Only
      valid if org.knopflerfish.framework.automanifest=true.
      An URL starting with "!!" followed by path is refer to a resource
      on the classloader that have loaded the framework.
    </td>
    <td>String</td>
    <td>!!/automanifest.props</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.bundlestorage</td>
    <td>
     Storage implementation for bundles
     [file, memory]
    </td>
    <td>String</td>
    <td>file</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.bundlestorage.file.always_unpack</td>
    <td>
     When using file bundle storage, bundle jars can be unpacked
     or copied as-is. Unpacking leads to faster restart and class loading
     but takes longer for initial startup.

     If set to true, unpack all bundle jars.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.bundlestorage.file.reference</td>
    <td>
     When using file bundle storage, file: URLs can optionally
     be referenced only, not copied to the persistant area.

     If set to true, file: URLs are referenced only.

     Note: Individual bundles can be reference installed
           by using URLs of the syntax:

              reference:file:<path>

           This works even if the global reference flag
           is not enabled.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.bundlestorage.file.trusted</td>
    <td>
     Are the bundles stored in the file bundle storage to be trusted, if not
     signed bundles will be checked every time they are read.
     Untrusted storafe leads to slower restart and class loading.

     If set to true, trust bundles in bundle storage.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.bundlestorage.file.unpack</td>
    <td>
     Most JVM requires that we unpack the bundle to access internal jars
     and native code. Setting this to true will unpack the jar if it contains
     internal jars or native code.

     If set to true, unpack needed bundle jars.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.system.packages.base</td>
    <td>
     An alternative to setting org.osgi.framework.system.packages.
     When this property is used the list of packages given will be
     appended with the default set of osgi-packges for the current
     framework and then used as the exports of the system bundle.
    </td>
    <td>String , ...</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.system.packages.file</td>
    <td>
      File containing list of packages exported by the system bundle.
    </td>
    <td>String</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.automanifest</td>
    <td>
      Print debug output for automatic manifest actions.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.bundle_resource</td>
    <td>
     When security is enabled, print information about resource
     lookups that are rejected due to missing permissions for the
     calling bundle.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.certficates</td>
    <td>
     Print debug information about certficate handling.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.classloader</td>
    <td>
     Print debug information from classloader
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.framework</td>
    <td>
     Print debug information about life-cycle events for the
     current framework instance.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.errors</td>
    <td>
     Print all FrameworkEvents of type ERROR
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.ldap</td>
    <td>
     Print debug information about LDAP filters
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.packages</td>
    <td>
     Print debug information about packages
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.patch</td>
    <td>
     Print debug information about class patching
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.permissions</td>
    <td>
     Print debug information about permission evaluation.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.print_with_do_privileged</td>
    <td>
     Surrond all debug print-operations originating from
     setting org.knopflerfish.debug.* properties with a
     doPrivileged() wrapper.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.startlevel</td>
    <td>
     Print debug information about startlevel service
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.service_reference</td>
    <td>
     When security is enabled, print information about service
     reference lookups that are rejected due to missing permissions
     for calling bundle.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.debug.url</td>
    <td>
      Print debug information about URL services
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.is_doublechecked_locking_safe</td>
    <td>
     Is it safe to use double-checked locking or not.
     It is safe if JSR 133 is included in the running JRE. I.e., for
     Java SE if version is 1.5 or higher.
    </td>
    <td>Boolean</td>
    <td>
      True if value of the system property java.version >= 1.5,
      False otherwise
    </td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.ldap.nocache</td>
    <td>
     Disable LDAP caching for simple filters. LDAP caching
     speeds up framework filters considerably, but uses
     more memory.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.main.class.activation</td>
    <td>
      A comma-separated list of locations of bundles whose Main-Class
      (set in manifest) should be used as activator if no
      BundleActivator is specified. 
      The Main-Class will be used as activator iff the jar file 
      does not specify a Bundle-Activator header and the bundle's
      location(see Bundle.getLocation) is found in the comma-separated
      list (case-sensitive). 
      > java -Dorg.knopflerfish.framework.main.class.activation=\ 
           file:/foo/bar.jar,http://foo.com/bar.jar \ 
           -jar framework.jar ...
    </td>
    <td>String</td>
    <td>-</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.main.verbosity</td>
    <td>
     Verbosity level of the Main class starting the framework. 0 means
     few messages.
    </td>
    <td>Integer</td>
    <td>0</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.patch</td>
    <td>
      If true AND the class org.objectweb.asm.ClassReader is available
      (by putting the asm-3.2.jar library on the system class path), enable
      runtime class patching.
      Example:
      java -Dorg.knopflerfish.framework.patch=true\
           -cp framework.jar:asm-3.2.jar \
           org.knopflerfish.framework.Main        
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.patch.configurl</td>
    <td>
     URL to class patch config file. Only used when class patching is enabled.
     This is used as a fallback if a bundle does not specify a
     Bundle-ClassPatcher-Config manifest header.

     "!!" is used to read resources from the system class path
     "!" can be used to read bundle resources.
    </td>
    <td>String</td>
    <td>!!/patches.props</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.patch.dumpclasses</td>
    <td>
     If true and class patchin is enabled, dump all modified classes
     to a directory.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.patch.dumpclasses.dir</td>
    <td>
      If dumpclasses is enabled, specifies a directory where to dump
      modified classes
    </td>
    <td>String</td>
    <td>patchedclasses</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.strictbootclassloading</td>
    <td>
      If set to true, use strict rules for loading classes from the boot class loader.
      If false, accept class loading from the boot class path from classes themselves
      on the boot class, but which incorrectly assumes they may access all of the boot
      classes on any class loader (such as the bundle class loader).
      Setting this to true will, for example, result in broken serialization on the Sun 
      JVM if bootdelegation does not exposes sun.* classes
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.usingwrapperscript</td>
    <td>
      If set to "true", KF will assume that it has been
      started with the "kf2" shell script, and that it will be 
      restarted if KF exits with exit code = 200. Required to be 
      able to use new KF2 features such as extension bundles. 
      This flag is set to "true" by the "kf2" shell script.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.validator</td>
    <td>
      A list of which certificate validators to use. Currently available are
      JKSValidator and SelfSignedValidator.
    </td>
    <td>String</td>
    <td>JKSValidator</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.validator.jks.ca_certs</td>
    <td>
      URL to java keystore used by JKSValidator.
    </td>
    <td></td>
    <td>file:$JAVA_HOME/lib/security/cacerts</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.validator.jks.ca_certs_password</td>
    <td>
      Password to java keystore used by JKSValidator.
    </td>
    <td>String</td>
    <td>changeit</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.write.restart.xargs</td>
    <td>
      Property that tells the Knopflerfish framework if it shall write a
      restart.xargs file with all framework properties inside the
      framework directory on startup or not.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.framework.xargs.writesysprops</td>
    <td>
      Properties defined using -Dname=value in xargs-files are available
      for bundles using BundleContext.getProperty(name).
      This property controls weather such properties shall also be
      exported as system properties or not.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.gosg.jars</td>
    <td>
     Semicolon separated list of base URLs for relative install commands
    </td>
    <td>URL;...</td>
    <td>file:jars/</td>
  </tr>
  <tr>
    <td>org.knopflerfish.permissions.initialdefault</td>
    <td>
     Initial default set of permission for PermissionAdmin service.
     Format for permission is same as used by 
     org.osgi.service.permissionadmin.PermissionInfo, i.e, 

       (type)                     or
       (type "name")              or
       (type "name" "actions")

     More than on permission can be set by separating items by ";"

     An empty set can be specified by using the empty string as value.
    </td>
    <td>String</td>
    <td>(java.security.AllPermission)</td>
  </tr>
  <tr>
    <td>org.knopflerfish.startlevel.use</td>
    <td>
      Use the Start Level service. If start level is not use then
      we do not create a non daemon thread that will keep a jvm
      with only daemon threads alive.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.startlevel.level</td>
    <td>
     level of start level service if used.
    </td>
    <td>Integer > 0</td>
    <td>1</td>
  </tr>
  <tr>
    <td>org.knopflerfish.startlevel.initlevel</td>
    <td>
     Initial start level of bundles if start level
     service if used.
    </td>
    <td>Integer > 0</td>
    <td>1</td>
  </tr>
  <tr>
    <td>org.knopflerfish.osgi.registerbundleurlhandler</td>
    <td>
     Flag for publicly exporting the bundle: special URL
     handler. If this is enabled, all bundles can create
     bundle: URLs for access it's own or other bundle's resources.

     The OSGi service based URL handlers (see above) _must_ 
     be active for publicly exporting bundle: URLs
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.osgi.setcontextclassloader</td>
    <td>
     If set to "true", set the bundle startup thread's context class
     loader to the bundle's class loader. This is useful for checking
     if an external lib will work better with a wrapped startup. It
     doesn't set the context classloader for event callbacks.

     Note that setting the context classloader is not mandated
     by OSGi, and might introduce dependecies on the KF framework,
     so this flag should only be enabled for testing purposes.
    </td>
    <td>Boolean</td>
    <td>False</td>
  </tr>
  <tr>
    <td>org.knopflerfish.servicereference.valid.during.unregistering</td>
    <td>
      If set to false, then the service reference can not be used to
      fetch an instance of the service during delivery and handling of
      the UNREGISTERING service event. This (false) is the behaviour
      specified in the OSGi R4.0.1 specification, according to a
      clarification done by CPEG February 2008 it shall now be possible
      to obtain a service instance during delivery of UNREGISTERING
      events thus this property now defaults to true.
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
  <tr>
    <td>org.knopflerfish.osgi.registerserviceurlhandler</td>
    <td>
      Flag for installing OSGi service based URL handlers. 
      Since the URL handler can only be installed once, there
      might be cased where some external entity (not OSGi)
      sets this. In this case, the OSGi handler can be disabled
      by setting 
    </td>
    <td>Boolean</td>
    <td>True</td>
  </tr>
</table>
