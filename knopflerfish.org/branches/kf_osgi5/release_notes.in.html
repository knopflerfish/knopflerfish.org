<!-- The first line in this file is used by the desktop to check -->
<!-- for new releases, i.e., do not change its format.           -->
<!-- It must contain the word "Knopflerfish" followed by a space -->
<!-- and then the version followed by another space.             -->

<h1 class="kf">Release Notes Knopflerfish $(VERSION) (OSGi R5)</h1>
<p>
  First release of Knopflerfish 5 available from
  $(BASE_URL)/$(VERSION). Released $(RELEASE_DATE).
</p>
<p>
  Knopflerfish 5 is an implementation of the "OSGi Service Platform
  Release 5". It contains all services specified in the
  "Core Specification" and most of the non Enterprise Edition related
  services specified in the "Compendium Specification".
</p>
<p>
  The Release Notes include all new features & changes for 
  Knopflerfish $(VERSION) compared to the release of Knopflerfish
  $(VERSION_PREV).
</p>

<h2 class="kf">Knopflerfish Framework - OSGi Core Specification</h2>
<div class="release_notes">

  <div class="note_group">
    <div class="note_name">OSGi R5 specification</div>
    <div class="note_item">
      All the Core Specification Services and API:s are included and are
      designed to be compliant with the OSGi R5 specification.
      Please refer to the <a href="components.html">Contents</a> page for
      a more detailed description of news in R5 and KF5 implementation status.
    </div>
  <div class="note_group">
    <div class="note_name"> Framework 7.0.1</div>
    <div class="note_item">
      Corrected handling of processor aliases in native-code matching.
    </div>
    <div class="note_item">
      Relaxed the matching in bundle classloader method findLibrary,
      to handle library names which already are system specific.
    </div>
    <div class="note_item">
      There is a new version of framework built called framework_compact.jar.
      This a version with a reduced memory footprint. This version has
      no security and certificate support compiled into it. This is only
      supposed to be used for running and not to compile against.
    </div>
    <div class="note_item">
      Unified API version handling. API version are now read from the
      <tt>packageinfo</tt> file in API source directory.
    </div>
    <div class="note_item">
      VersionRange class. OSGi standard class for handling OSGi version ranges.
    </div>
  </div>
</div>


<h2 class="kf">OSGi Compendium Specification</h2>
<div class="release_notes">

  <div class="note_group">
    <div class="note_name">Blueprint 5.0.0</div>
    <div class="note_item">
      Update (micro version) of OSGi packages. 
    </div>
  </div>
  
  <div class="note_group">
    <div class="note_name">CM 5.0.0</div>
    <div class="note_item">
      CM is updated to comply with new Configuration Admin Service
      version(1.5) that was specified in OSGi Compendium
      specification R5.
    </div>
    <div class="note_item">
      A new method <code>Configuration.getChangeCount()</code>.
    </div>
    <div class="note_item">
      New listener interface
	  <code>SynchronousConfigurationListener</code>.
    </div>
    <div class="note_item">
      New concept Targeted PIDs. The target PID scopes the applicability
      of a configuration to a limited set of target bundle based on
      PID, Bundle-Symbolic-Name, Version and Location. 
    </div>
  </div>
  
  <div class="note_group">
    <div class="note_name">Component Annotations API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.component.annotations</code> package.

    </div>
    <div class="note_item">

      This API-bundle is for compile time use, since the annotations
      are used by the build system to create the XML-file describing a
      component. A Service Component Runtime (SCR) does not use / need
      the annotations since its source of information is the XML-file.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Coordinator API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.coordinator</code> package.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">DMT 5.0.0</div>
    <div class="note_item">
      Update (micro version) of OSGi packages. 
    </div>
  </div>
  
  <div class="note_group">
    <div class="note_name">Log Service 5.0.0</div>
    <div class="note_item">
      Allow the use of bundle id's as key part in the values of the
     <em>bundle.log.level</em> configuration attribute.
    </div>
    <div class="note_item">
      Corrected an invalid error message for the
     <em>bundle.log.level</em> configuration attribute.
    </div>
  </div>
  
  <div class="note_group">
    <div class="note_name">KF-XML-Metatype 5.0.0</div>
    <div class="note_item">
      The default values for an attribute definition is now validated
      against the set of allowed option values when option values are
      defined. Any default value that is not a valid option value will
      be ignored.
    </div>
  </div>
  
  <div class="note_group">
    <div class="note_name">Namespace API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.namespace.*</code> packages that was added
      in OSGi R5.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Remote Service Admin API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.remoteserviceadmin</code> package.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Repository API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.repository</code> package that was added
      in OSGi R5.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Resolver API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.resolver</code> package that was added
      in OSGi R5.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Repository XML 1.0.0</div>
    <div class="note_item">

      New bundle providing an OSGi repository service based on data
      from XML documents following the OSGi specified repository
      schema, <code>http://www.osgi.org/xmlns/repository/v1.0.0</code>.

    </div>
  </div>

  </div>
    <div class="note_group">
    <div class="note_name">SCR(component) 5.0.0</div>
    <div class="note_item">
      Updated API micro version to 1.2.1 because of added
      generics types to methods. 
    </div>
    <div class="note_item">
      Updated CM handling to handle targeted PIDs that
      was introduced in Configuration Admin(CM) 5.0.0.
    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Service Loader API 1.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.serviceloader</code> package.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Subsystem API 5.0.0</div>
    <div class="note_item">

      New API bundle providing the
      <code>org.osgi.service.subsystem</code> package.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">WireAdmin 5.0.0</div>
    <div class="note_item">
      Update (micro version) of OSGi packages. 
    </div>

</div>

<h2 class="kf">Knopflerfish Services</h2>
<div class="release_notes">

  <div class="note_group">
    <div class="note_name">CM-Commands 5.0.1</div>
    <div class="note_item">

      Calling the <em>show</em> command without calling the
      <em>list</em>-command before resulted in an error message.

    </div>
    <div class="note_item">

      Updated to require and use the Configuration Admin version 1.5.
      I.e., 
      <ul>
	<li>Presents the change count when showing a configuration,

        <li>uses the change count to detect if a save will overwrite
	    changes to the configuration done by some other management
	    agent.
      </ul>

    </div>
    <div class="note_item">

      The <code>create</code> command has been extended to take the
      PID of a configuration used as template for the new
      configuration. This command now also check that the new PID is
      not already in use.

    </div>
    <div class="note_item">

      The <code>show</code> and the <code>current</code> commands has
      a new option, <code>-t</code> that when present includes the
      type of each property in the printout.

    </div>
  </div>
  
  <div class="note_group">
    <div class="note_name">CM-Desktop 5.0.1</div>
    <div class="note_item">

      Updated to require and use the Configuration Admin version 1.5.
      I.e., 
      <ul>
	<li> Works with configurations using targeted PIDs.
      </ul>

    </div>
    <div class="note_item">

      The user interface has been rewritten to support targeted PIDs
      and to increase performance by reducing the number of Swing
      components it uses and updates when a configuration is updated.

    </div>
    <div class="note_item">

      Buttons in the GUI is now made inactive (disabled) when they do
      not have a function (previously they where made invisible).

    </div>
    <div class="note_item">

      The page shown when no bundle is selected or when a bundle
      without meta type information is selected now lists all bundles
      that provides metatype information. This page also provides an
      import-button for importing cm_data XML documents (that can be
      created by the export button on the page for an individual
      configuration).

    </div>
    <div class="note_item">

      This bundle can now use any MetaTypeService service. I.e., it no
      longer requires the SystemMetattypeProvider service provided by
      the kf_metatype-bundle.

    </div>
    <div class="note_item">

      Uses the new functionality provided by Desktop 5.0 to avoid
      updating the displayer when not visible.

    </div>
  </div>
  

  <div class="note_group">
    <div class="note_name">Console TCP 5.0.0</div>
    <div class="note_item">

      Added metatype describing the configuration this bundle accepts.
      
    </div>
    <div class="note_item">

      Made the default user name and password configurable.
      
    </div>
  </div>


  <div class="note_group">
    <div class="note_name">Desktop 5.0.1</div>
    <div class="note_item">

      The bundle wiring displayer now presents attribute values that
      are URLs in the identity namespace as links.
      
    </div>

    <div class="note_item">

      Fixed a problem with the presentation of bundle license header
      for external licenses in the manifest displayer.
      
    </div>

    <div class="note_item">

      The icons displayer now loads bundle icons from inside a bundle
      without resolving the bundle.
      
    </div>

    <div class="note_item">

      The manifest view now supports the <em>Bundle-License</em>
      header and creates links for both the name and the link
      attribute when applicable.
      
    </div>

    <div class="note_item">

      Added support for external bundles that registers detail
      displayers to support lazy updates, i.e., only update the
      displayer views when the displayer is visible in the tabbed pane
      it lives in. A displayer that wants to use this feature must
      implement the new interface,
      <code>org.knopflerfish.service.desktop.SelectionAware</code>.
      
    </div>
  </div>
  

  <div class="note_group">
    <div class="note_name">LogCommands 5.0.0</div>
    <div class="note_item">

      Added support for handling configurations with
      <em>bundle.log.level</em> that uses a bundle id to specify the
      bundle that the vector item applies to.

    </div>
  </div>

  
  <div class="note_group">
    <div class="note_name">Repository Commands 1.0.0</div>
    <div class="note_item">

      New bundle that provides console commands for interacting with
      the repository manager service.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Repository Desktop 1.0.0</div>
    <div class="note_item">

      New desktop viewer bundle that supports the new OSGi R5
      specified Repository service format. This bundle interacts with
      repository services via the repository manager service.

    </div>
    <div class="note_item">

      The repository desktop bundle replaces the OSCAR based
      Bundlerepository 3.1.3 bundle that has been removed from
      Knopflerfish. Since the bundlerepository-bundle was the only
      bundle using the OSCAR shell bundle that bridged between the
      Knopflerfish console the <code>oscar-shell</code> bundle has
      also been removed.

    </div>
    <div class="note_item">

      In this release there is no Resolver service, this this bundle
      will only install the selected bundle itself, not any other
      bundle that might be needed to get the selected bundle fully
      functional.

    </div>
  </div>

  <div class="note_group">
    <div class="note_name">Repository Manager 1.0.0</div>
    <div class="note_item">

      New bundle that tracks all repository services and provides a
      method to search them. Repositories can be given a rank to
      control the search order and they can be temporarily disabled
      during the searches performed by via the repository manager
      service.

    </div>
  </div>

  
  <div class="note_group">
    <div class="note_name">Xerces 2.10.1.kf5</div>
    <div class="note_item">
      This bundle now imports and exports the
      <code>org.osgi.util.xml</code> package.
    </div>
  </div>

</div>


<h2 class="kf">Misc, start scripts, build system etc </h2>
<div class="release_notes">

  <div class="note_group">
    <div class="note_name">Build system</div>
    <div class="note_item">

      The build system now supports compiling with Java 7.  When
      compiling with <code>javac</code> from Java 7 it is not possible
      to generate code that is backwards compatible with JDK 1.4 thus
      code will be generated for Java 5. Also note that the current
      OSGi/Minimum execution environment jar can not be used as boot
      class path when compiling code that uses the enhanced for loop
      with Java 7 since it does not contain the java.lang.Iterable
      class. Thus until we have a better jar to use as boot class
      path any requirement in the OSGi/Minimum execution environment
      will be replaced with a requirement on Java SE 5 and the Java 7
      runtime will be used as the boot class path.

    </div>

    <div class="note_item">

      The <code>default</code>-target in the top-level build file as
      well as that in the OSGi-level build file now builds all bundles
      except for the test-bundles in the
      <code>osgi/bundles_test</code>-directory.

    </div>

    <div class="note_item">

      Bundle kind specific manifest headers for other kinds of bundles
      than the one that is currently built is no longer propagated to
      the resulting manifest file.

    </div>

    <div class="note_item">

      The ant properties <code>do.bundle.custom.pre</code> and
      <code>do.bundle.custom.post</code> are now deprecated and thus
      ignored. If a build file contains a
      <code>bundle.custom.pre</code> or a
      <code>bundle.custom.post</code>  target they will always be
      executed before / after the <code>all</code>-target. Both the
      pre and the post targets are now executed in the same ant-level
      as the all target, thus any property or references defined inside
      the pre and post targets are now visible when executing the
      <code>all</code>-target.

    </div>

    <div class="note_item">

      The default file encoding for source files has changed from the
      local file encoding (as specified by the system property
      file.encoding) to UTF8. To override this set the ant property
      javac.encoding in your build file before importing
      bundlebuild.xml.

    </div>

  </div>

</div>
