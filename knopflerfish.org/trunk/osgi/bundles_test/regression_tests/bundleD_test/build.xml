<?xml version="1.0"?>

<!DOCTYPE project [
  <!ENTITY bundlebuild_include  SYSTEM "../../../../ant/bundlebuild_include.xml">
]>

<project name="bundleD_test" default="all">

  <property name="topdir"       location="../../.."/>

  <property name  = "api.pattern"
            value = "org/knopflerfish/service/**"/>

  <property name  = "impl.pattern"
            value = "org/knopflerfish/bundle/**"/>

  <property name = "outdir"   location = "${topdir}/out/${ant.project.name}"/>
  <property name = "jardir"   location = "${topdir}/jars/${ant.project.name}"/>
  <property name = "classes.out.dir"     location = "${outdir}/classes"/>
  <property name = "src.dir"             location = "src"/>

  <property name = "bundle.version"      value = "1.0.0"/>
  
 <property name     = "all.jar"
           location = "${jardir}/${ant.project.name}_all-${bundle.version}.jar"/>


  <path id = "framework.path">
    <pathelement location = "${topdir}/framework.jar"/>
  </path>

   <target name        = "compile" 
         description = "compiles all java sources">

    <mkdir dir = "${classes.out.dir}"/>

    <javac destdir       = "${classes.out.dir}" 
           debug         = "on"
           srcdir        = "${src.dir}"
           target        = "1.2"
           classpathref  = "framework.path"
           includes      = "${impl.pattern},${api.pattern}"
    >
   </javac>
  </target>

  <target name        = "jar">
   <mkdir dir="${jardir}/${ant.project.name}"/>

   <jar basedir  = "${classes.out.dir}"
       jarfile  = "${all.jar}"
       includes = "${impl.pattern},{api.pattern}"
    >
   </jar>  
  </target>

  <target name = "all" depends="compile,jar">
  </target>

 <target name = "clean" description = "Removes all files in utput directory">
  <delete dir = "${outdir}"/>
  <delete dir = "${jardir}"/>
 </target>

</project>



